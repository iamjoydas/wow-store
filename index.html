<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Store</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        :root {
            --background-color: #0a0a1a; --surface-color: rgba(30, 30, 50, 0.5);
            --glass-border: rgba(255, 255, 255, 0.1); --text-primary: #f0f0f0; --text-secondary: #a0a0b0;
            --primary-action: #00ff8c; --accent-color: #ff4757; --star-color: #ffd700;
            --glow-green: rgba(0, 255, 140, 0.6); --glow-red: rgba(255, 71, 87, 0.6);
            --font-family: 'Poppins', sans-serif; --border-radius: 16px;
        }
        body { font-family: var(--font-family); background: #121212 radial-gradient(circle at top left, #1a1a2e, #0a0a1a); color: var(--text-primary); margin: 0; padding: 0; overflow-x: hidden; min-height: 100vh; }
        .container { max-width: 800px; margin: 0 auto; padding: 15px; z-index: 10; position: relative; }
        .glassmorphic { background: var(--surface-color); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: var(--border-radius); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3); }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; margin-bottom: 25px; position: sticky; top: 15px; z-index: 1000; }
        .store-info { display: flex; align-items: center; gap: 15px; } #store-logo { width: 45px; height: 45px; border-radius: 10px; object-fit: cover; }
        #store-name { font-size: 1.6em; font-weight: 700; margin: 0; color: var(--primary-action); text-shadow: 0 0 10px var(--glow-green); }
        .btn { display: flex; align-items: center; gap: 8px; padding: 10px 18px; border: none; border-radius: 12px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .btn-donate { background-color: transparent; border: 1px solid var(--accent-color); color: var(--text-primary); }
        .btn-donate:hover { background-color: var(--accent-color); box-shadow: 0 0 20px var(--glow-red); }
        .btn-download { background-color: var(--primary-action); color: #000; }
        .btn-download:hover { transform: translateY(-3px); box-shadow: 0 0 25px var(--glow-green); }
        .input-wrapper { position: relative; width: 100%; } .input-wrapper svg { position: absolute; top: 50%; left: 15px; transform: translateY(-50%); width: 20px; height: 20px; stroke: var(--text-secondary); }
        #search-bar { width: 100%; padding: 14px 14px 14px 50px; font-size: 1em; color: var(--text-primary); border: 1px solid var(--glass-border); background-color: rgba(0,0,0,0.2); border-radius: 12px; transition: all 0.3s ease; box-sizing: border-box; }
        #search-bar:focus { outline: none; box-shadow: 0 0 15px var(--glow-green); border-color: var(--primary-action); }
        #ad-container { display: flex; justify-content: center; margin: 25px 0; }
        #app-list { display: flex; flex-direction: column; gap: 15px; }
        .app-item { display: flex; align-items: center; padding: 15px; cursor: pointer; transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease; }
        .app-item:hover { transform: scale(1.02); border-color: var(--primary-action); box-shadow: 0 0 20px rgba(0, 0, 0, 0.5); }
        .app-logo { width: 60px; height: 60px; border-radius: 14px; margin-right: 15px; object-fit: cover; flex-shrink: 0; } .app-text { flex-grow: 1; }
        .app-title { font-weight: 600; font-size: 1.2em; margin: 0; } .app-subtitle { font-size: 0.9em; color: var(--text-secondary); margin: 4px 0 0 0; }
        #app-detail-view { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--background-color); z-index: 2000; overflow-y: auto; transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        #app-detail-view.visible { transform: translateX(0); }
        .detail-header { padding: 15px; position: sticky; top: 0; background: rgba(10, 10, 26, 0.8); backdrop-filter: blur(10px); z-index: 10; }
        .detail-main { padding: 20px; }
        .detail-top-section { display: flex; flex-direction: column; align-items: center; text-align: center; gap: 15px; margin-bottom: 30px; }
        #detail-logo { width: 120px; height: 120px; border-radius: 28px; object-fit: cover; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #detail-title { font-size: 2.2em; font-weight: 700; margin: 0; color: var(--primary-action); text-shadow: 0 0 15px var(--glow-green); }
        .detail-section { padding: 20px; margin-bottom: 20px; } .detail-section h3 { margin: 0 0 15px 0; font-size: 1.4em; color: var(--primary-action); border-bottom: 1px solid var(--glass-border); padding-bottom: 10px; }
        #screenshots-container { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 15px; }
        .screenshot { height: 280px; border-radius: 12px; object-fit: cover; border: 1px solid var(--glass-border); }
    </style>
</head>
<body>
    <div class="container" id="main-view">
        <header class="header glassmorphic">
            <div class="store-info"><img id="store-logo" src=""><h1 id="store-name"></h1></div>
            <button id="donate-btn" class="btn btn-donate"><svg xmlns="http://www.w.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>Donate</button>
        </header>
        <div class="input-wrapper"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" id="search-bar" placeholder="Search apps..."></div>
        <div id="ad-container"><script type="text/javascript">atOptions={key:'806848c2472eb53ca9b2fdb0d6109157',format:'iframe',height:50,width:320,params:{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/806848c2472eb53ca9b2fdb0d6109157/invoke.js"></script></div>
        <main id="app-list"></main>
    </div>
    <div id="app-detail-view">
        <div class="detail-header"><button id="back-btn" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>Back</button></div>
        <div class="detail-main">
            <section class="detail-top-section"><img id="detail-logo"><div id="detail-info"><h2 id="detail-title"></h2><p id="detail-subtitle"></p></div><a href="#" id="detail-download-btn-top" class="btn btn-download"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>Download</a></section>
            
            <!-- RATING SECTION REMOVED AND ADS ADDED HERE -->
            <section class="detail-section glassmorphic" style="display: flex; justify-content: center; align-items: center;">
                <script type="text/javascript">
                    atOptions = {
                        'key' : '806848c2472eb53ca9b2fdb0d6109157', // Replace with your ad unit key
                        'format' : 'iframe',
                        'height' : 250,
                        'width' : 300,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/806848c2472eb53ca9b2fdb0d6109157/invoke.js"></script>
            </section>
            
            <section class="detail-section glassmorphic"><h3>Screenshots</h3><div id="screenshots-container"></div></section>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = { apiKey: "AIzaSyBByqjs_2kV-RQgtMzbszFWtVtuc170csE", authDomain: "wow-store-9ce56.firebaseapp.com", databaseURL: "https://wow-store-9ce56-default-rtdb.firebaseio.com", projectId: "wow-store-9ce56", storageBucket: "wow-store-9ce56.appspot.com", messagingSenderId: "55020851171", appId: "1:55020851171:web:10db7b2eb3f12b7f889ad6" };
        firebase.initializeApp(firebaseConfig); const database = firebase.database(); let allApps = [], currentAppId = null, upiConfig = { id: '', name: '' };
        
        // Removed stars and avgRating from UI object
        const ui = { storeName: document.getElementById('store-name'), storeLogo: document.getElementById('store-logo'), donateBtn: document.getElementById('donate-btn'), searchBar: document.getElementById('search-bar'), appList: document.getElementById('app-list'), appDetailView: document.getElementById('app-detail-view'), backBtn: document.getElementById('back-btn'), detail: { logo: document.getElementById('detail-logo'), title: document.getElementById('detail-title'), subtitle: document.getElementById('detail-subtitle'), description: document.getElementById('detail-description'), screenshots: document.getElementById('screenshots-container'), downloadTop: document.getElementById('detail-download-btn-top') } };
        
        const debounce = (func, delay) => { let timeout; return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), delay); }; };
        
        function initializeStore() {
            database.ref('settings').on('value', s => { const d = s.val(); if (d) { ui.storeName.textContent = d.storeName || 'App Store'; ui.storeLogo.src = d.storeLogo || ''; upiConfig.name = d.storeName || 'App Store'; document.title = d.storeName || 'App Store'; } });
            database.ref('upi/id').on('value', s => { upiConfig.id = s.val() || ''; });
            database.ref('apps').on('value', s => { const d = s.val(); allApps = d ? Object.keys(d).map(k => ({ id: k, ...d[k] })) : []; renderApps(); });
        }
        
        function renderApps() {
            const term = ui.searchBar.value.toLowerCase(); const filtered = allApps.filter(app => app.title.toLowerCase().includes(term));
            ui.appList.innerHTML = filtered.length === 0 ? '<p style="text-align:center;">No apps found.</p>' : filtered.map(app => `<div class="app-item glassmorphic" data-id="${app.id}"><img src="${app.logo}" class="app-logo"><div class="app-text"><h3 class="app-title">${app.title}</h3><p class="app-subtitle">${app.subtitle}</p></div><div class="btn btn-download"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></div></div>`).join('');
        }
        
        function showAppDetails(appId) {
            currentAppId = appId; const app = allApps.find(a => a.id === appId); if (!app) return;
            ui.detail.logo.src = app.logo; ui.detail.title.textContent = app.title; ui.detail.subtitle.textContent = app.subtitle;
            const descriptionContainer = document.getElementById('detail-description'); if(descriptionContainer) descriptionContainer.textContent = app.description || '';
            ui.detail.screenshots.innerHTML = (app.screenshots && app.screenshots.length > 0) ? app.screenshots.map(url => `<img src="${url}" class="screenshot">`).join('') : '<p>No screenshots available.</p>';
            ui.detail.downloadTop.href = app.downloadLink;
            // Removed loadRatings(appId);
            ui.appDetailView.classList.add('visible'); document.body.style.overflow = 'hidden';
        }
        
        function hideAppDetails() { ui.appDetailView.classList.remove('visible'); document.body.style.overflow = 'auto'; currentAppId = null; }
        
        // REMOVED: loadRatings, submitRating, updateStarsUI functions
        
        function getDeviceId() { let id = localStorage.getItem('techdroid_device_id'); if (!id) { id = 'user_' + Math.random().toString(36).substr(2, 16); localStorage.setItem('techdroid_device_id', id); } return id; }
        
        ui.searchBar.addEventListener('input', debounce(renderApps, 300));
        ui.appList.addEventListener('click', e => { const item = e.target.closest('.app-item'); if (!item) return; const app = allApps.find(a => a.id === item.dataset.id); if (e.target.closest('.btn-download')) { window.location.href = app.downloadLink; } else { showAppDetails(app.id); } });
        ui.backBtn.addEventListener('click', hideAppDetails);
        ui.donateBtn.addEventListener('click', () => { if (upiConfig.id) window.location.href = `upi://pay?pa=${upiConfig.id}&pn=${encodeURIComponent(upiConfig.name)}&cu=INR`; else alert('Donation info not set.'); });

        // REMOVED: Stars event listener
        
        document.addEventListener('DOMContentLoaded', initializeStore);
    </script>
</body>
</html>